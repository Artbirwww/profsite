import { useState, useEffect } from 'react';
import { SimpleButton as Button } from './SimpleButton';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from './SimpleUI';
import { SimpleProgress as Progress } from './SimpleProgress';
import { ArrowLeft, Clock } from './SimpleIcons';
import type { User, TestResult } from '../App';

interface TemperamentTestProps {
  user: User;
  onComplete: (result: Partial<TestResult>) => void;
  onBack: () => void;
}

// –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –±–∞–ª–ª–æ–≤ (–Ω–∞ –æ—Å–Ω–æ–≤–µ Unity –∫–æ–¥–∞)
const ExtraIntrMap: { [key: number]: boolean } = {
  1: true, 3: true, 8: true, 10: true, 13: true, 17: true, 22: true,
  25: true, 27: true, 39: true, 44: true, 46: true, 49: true, 53: true, 56: true,
  5: false, 15: false, 20: false, 29: false, 32: false, 34: false,
  37: false, 41: false, 51: false
};

const NeiroMap: { [key: number]: boolean } = {
  2: true, 4: true, 7: true, 9: true, 11: true, 14: true, 16: true,
  19: true, 21: true, 23: true, 26: true, 28: true, 31: true, 33: true,
  35: true, 38: true, 40: true, 43: true, 45: true, 47: true, 50: true,
  52: true, 55: true, 57: true
};

const LieMap: { [key: number]: boolean } = {
  6: true, 24: true, 36: true,
  12: false, 18: false, 30: false, 42: false, 48: false, 54: false
};

// –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ê
const questionsA = [
  '–ß–∞—Å—Ç–æ –ª–∏ –≤–∞–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–µ?',
  '–ù—É–∂–Ω—ã –ª–∏ –≤–∞–º –¥—Ä—É–∑—å—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–∞—Å –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏–ª–∏ –ø–æ–Ω—è—Ç—å, –∫–æ–≥–¥–∞ –≤–∞–º –≥—Ä—É—Å—Ç–Ω–æ?',
  '–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–±—è —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –∏ –Ω–µ –≤–æ–ª–Ω—É–µ—Ç—Å—è?',
  '–õ–µ–≥–∫–æ –ª–∏ –≤–∞–º –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–∏ –ø–ª–∞–Ω—ã, –µ—Å–ª–∏ –≤—ã —á—Ç–æ-—Ç–æ –∑–∞–¥—É–º–∞–ª–∏?',
  '–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥—É–º–∞—Ç—å, –ø—Ä–µ–∂–¥–µ —á–µ–º –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ?',
  '–í—Å–µ–≥–¥–∞ –ª–∏ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ –æ–±–µ—â–∞–Ω–∏—è, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ —Å–ª–æ–∂–Ω–æ –¥–ª—è –≤–∞—Å?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å –¥–Ω–∏, –∫–æ–≥–¥–∞ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, –∞ –ø–æ—Ç–æ–º –≤–¥—Ä—É–≥ –ø–ª–æ—Ö–æ?',
  '–û–±—ã—á–Ω–æ –≤—ã –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —Ä–µ—à–µ–Ω–∏—è –∏ –≥–æ–≤–æ—Ä–∏—Ç–µ, –Ω–µ –∑–∞–¥—É–º—ã–≤–∞—è—Å—å –¥–æ–ª–≥–æ?',
  '–ß—É–≤—Å—Ç–≤–æ–≤–∞–ª–∏ –ª–∏ –≤—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –≥—Ä—É—Å—Ç—å, –¥–∞–∂–µ –Ω–µ –∑–Ω–∞—è, –ø–æ—á–µ–º—É?',
  '–í–µ—Ä–Ω–æ –ª–∏, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤—ã —Ä–∏—Å–∫–Ω—É—Ç—å —Ä–∞–¥–∏ —Å–ø–æ—Ä–∞?',
  '–°–º—É—â–∞–µ—Ç–µ—Å—å –ª–∏ –≤—ã, –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —á–µ–ª–æ–≤–µ–∫–æ–º –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –ø–æ–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º —Å–∏–º–ø–∞—Ç–∏—á–µ–Ω?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —Ç–∞–∫, —á—Ç–æ –≤—ã —Å–∏–ª—å–Ω–æ —Å–µ—Ä–¥–∏—Ç–µ—Å—å –∏ —Ç–µ—Ä—è–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—å?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã –¥–µ–ª–∞–µ—Ç–µ —á—Ç–æ-—Ç–æ, –Ω–µ –ø–æ–¥—É–º–∞–≤ –∑–∞—Ä–∞–Ω–µ–µ, –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤–∞—Å –±–µ—Å–ø–æ–∫–æ—è—Ç –º—ã—Å–ª–∏ –æ —Ç–æ–º, —á—Ç–æ –≤—ã —Å–∫–∞–∑–∞–ª–∏ –∏–ª–∏ —Å–¥–µ–ª–∞–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫?',
  '–í–∞–º –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —á–∏—Ç–∞—Ç—å –∫–Ω–∏–≥–∏, —á–µ–º –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —Å –ª—é–¥—å–º–∏?',
  '–õ–µ–≥–∫–æ –ª–∏ –≤–∞—Å –æ–±–∏–¥–µ—Ç—å?',
  '–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≤—Ä–µ–º—è —Å –¥—Ä—É–∑—å—è–º–∏?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å –º—ã—Å–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –¥—Ä—É–≥–∏–º?',
  '–í–µ—Ä–Ω–æ –ª–∏, —á—Ç–æ –∏–Ω–æ–≥–¥–∞ –≤—ã –ø–æ–ª–Ω—ã —ç–Ω–µ—Ä–≥–∏–∏ –∏ –≥–æ—Ç–æ–≤—ã –∫–æ –≤—Å–µ–º—É, –∞ –∏–Ω–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –æ—á–µ–Ω—å —É—Å—Ç–∞–≤—à–∏–º?',
  '–í—ã —Å—Ç–∞—Ä–∞–µ—Ç–µ—Å—å –¥—Ä—É–∂–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å –º–∞–ª–µ–Ω—å–∫–∏–º –∫—Ä—É–≥–æ–º —Å–∞–º—ã—Ö –±–ª–∏–∑–∫–∏—Ö –¥—Ä—É–∑–µ–π?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã –º–µ—á—Ç–∞–µ—Ç–µ –æ —á–µ–º-—Ç–æ?',
  '–ö–æ–≥–¥–∞ –Ω–∞ –≤–∞—Å –∫—Ä–∏—á–∞—Ç, –æ—Ç–≤–µ—á–∞–µ—Ç–µ –ª–∏ –≤—ã —Ç–µ–º –∂–µ?',
  '–î—É–º–∞–µ—Ç–µ –ª–∏ –≤—ã, —á—Ç–æ –≤—Å–µ –≤–∞—à–∏ –ø—Ä–∏–≤—ã—á–∫–∏ —Ö–æ—Ä–æ—à–∏–µ?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, —á—Ç–æ –≤–∏–Ω–æ–≤–∞—Ç—ã –≤ —á–µ–º-—Ç–æ?',
  '–ú–æ–∂–µ—Ç–µ –ª–∏ –≤—ã –∏–Ω–æ–≥–¥–∞ —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è –∏ –ø–æ–≤–µ—Å–µ–ª–∏—Ç—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –æ—á–µ–Ω—å –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–º?',
  '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—â–∞—Ç—å—Å—è —Å –≤–µ—Å–µ–ª—ã–º–∏ –∏ –∂–∏–∑–Ω–µ—Ä–∞–¥–æ—Å—Ç–Ω—ã–º–∏ –ª—é–¥—å–º–∏?',
  '–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞–µ—Ç–µ, —á–∞—Å—Ç–æ –ª–∏ –≤—ã –¥—É–º–∞–µ—Ç–µ, —á—Ç–æ –º–æ–≥–ª–∏ –±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –ª—É—á—à–µ?',
  '–ß—É–≤—Å—Ç–≤—É–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–±—è –Ω–µ–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –≤ –±–æ–ª—å—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏?',
  '–ü–µ—Ä–µ–¥–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–ª—É—Ö–∏ –æ –¥—Ä—É–≥–∏—Ö?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —Ç–∞–∫, —á—Ç–æ –≤–∞–º –Ω–µ —Å–ø–∏—Ç—Å—è –∏–∑-–∑–∞ —Ä–∞–∑–Ω—ã—Ö –º—ã—Å–ª–µ–π?',
  '–ö–∞–∫ –≤–∞–º —É–¥–æ–±–Ω–µ–µ —É–∑–Ω–∞—Ç—å —á—Ç–æ-—Ç–æ: –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ –∫–Ω–∏–≥–µ –∏–ª–∏ —Å–ø—Ä–æ—Å–∏—Ç—å —É –¥—Ä—É–∑–µ–π?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å —Å–∏–ª—å–Ω—ã–µ —É–¥–∞—Ä—ã —Å–µ—Ä–¥—Ü–∞?',
  '–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º —Ä–∞–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å –ø—Ä–∏—Å—Ç—É–ø—ã –¥—Ä–æ–∂–∏?',
  '–í—Å–µ–≥–¥–∞ –ª–∏ –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–¥—É?',
  '–í–∞–º –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ, –∫–æ–≥–¥–∞ –≤—Å–µ —à—É—Ç—è—Ç –¥—Ä—É–≥ –Ω–∞–¥ –¥—Ä—É–≥–æ–º?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç–µ—Å—å?',
  '–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è?',
  '–î—É–º–∞–µ—Ç–µ –ª–∏ –≤—ã —á–∞—Å—Ç–æ –æ —Ä–∞–∑–Ω—ã—Ö –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ—Å—Ç—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã —Å–ª—É—á–∏—Ç—å—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Å–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å —Ö–æ—Ä–æ—à–æ?',
  '–í–µ—Ä–Ω–æ –ª–∏, —á—Ç–æ –≤—ã –¥–≤–∏–≥–∞–µ—Ç–µ—Å—å –º–µ–¥–ª–µ–Ω–Ω–æ –∏ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ?',
  '–û–ø–∞–∑–¥—ã–≤–∞–ª–∏ –ª–∏ –≤—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è –∏–ª–∏ –≤—Å—Ç—Ä–µ—á–∏?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤–∞–º —Å–Ω—è—Ç—Å—è –ø–ª–æ—Ö–∏–µ —Å–Ω—ã?',
  '–í—ã —Ç–∞–∫ –ª—é–±–∏—Ç–µ –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ–≥–¥–∞ –∏—â–µ—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ –ª—é–¥—å–º–∏?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å –∫–∞–∫–∏–µ-–Ω–∏–±—É–¥—å –±–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞—Å –±–µ—Å–ø–æ–∫–æ—è—Ç?',
  '–û–≥–æ—Ä—á–∏–ª–∏—Å—å –±—ã –≤—ã, –µ—Å–ª–∏ –±—ã –¥–æ–ª–≥–æ –Ω–µ –º–æ–≥–ª–∏ —É–≤–∏–¥–µ—Ç—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏?',
  '–°—á–∏—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–±—è –Ω–µ—Ä–≤–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º?',
  '–ï—Å—Ç—å –ª–∏ —Å—Ä–µ–¥–∏ –≤–∞—à–∏—Ö –∑–Ω–∞–∫–æ–º—ã—Ö —Ç–µ, –∫—Ç–æ –≤–∞–º –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è?',
  '–ú–æ–∂–µ—Ç–µ –ª–∏ –≤—ã —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤—ã –≤–µ—Ä–∏—Ç–µ –≤ —Å–µ–±—è?',
  '–õ–µ–≥–∫–æ –ª–∏ –≤–∞–º –æ–±–∏–∂–∞—Ç—å—Å—è, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –∫—Ä–∏—Ç–∏–∫—É–µ—Ç –≤–∞—Å –∏–ª–∏ –≤–∞—à—É —Ä–∞–±–æ—Ç—É?',
  '–¢—Ä—É–¥–Ω–æ –ª–∏ –≤–∞–º –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏, –≥–¥–µ –º–Ω–æ–≥–æ –ª—é–¥–µ–π?',
  '–ß—É–≤—Å—Ç–≤—É–µ—Ç–µ –ª–∏ –≤—ã —Å–µ–±—è —Ö—É–∂–µ –¥—Ä—É–≥–∏—Ö?',
  '–ú–æ–∂–µ—Ç–µ –ª–∏ –≤—ã —Å–¥–µ–ª–∞—Ç—å —Å–∫—É—á–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é –±–æ–ª–µ–µ –≤–µ—Å–µ–ª–æ–π?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —Ç–∞–∫, —á—Ç–æ –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ –æ –≤–µ—â–∞—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ—Å—å?',
  '–ë–µ—Å–ø–æ–∫–æ–∏—Ç–µ—Å—å –ª–∏ –≤—ã –æ —Ç–æ–º, –∫–∞–∫ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?',
  '–õ—é–±–∏—Ç–µ –ª–∏ –≤—ã –ø–æ–¥—à—É—Ç–∏—Ç—å –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏ –ª—é–¥—å–º–∏?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏, —á—Ç–æ –≤–∞–º —Ç—Ä—É–¥–Ω–æ –∑–∞—Å–Ω—É—Ç—å?',
];

// –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ë
const questionsB = [
  '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–æ–≥–¥–∞ –≤–æ–∫—Ä—É–≥ –º–Ω–æ–≥–æ –ª—é–¥–µ–π –∏ –≤–µ—Å–µ–ª—å—è?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —É –≤–∞—Å —á—É–≤—Å—Ç–≤–æ, —á—Ç–æ –≤–∞–º —á–µ–≥–æ-—Ç–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, –Ω–æ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ —á–µ–≥–æ?',
  '–í—ã —É–º–µ–µ—Ç–µ –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–ª–æ–≤–∞, –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ —á—Ç–æ-—Ç–æ —Å–∫–∞–∑–∞—Ç—å?',
  '–ò–Ω–æ–≥–¥–∞ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —Ä–∞–¥–æ—Å—Ç–Ω—ã–º, –∞ –∏–Ω–æ–≥–¥–∞ –≥—Ä—É—Å—Ç–Ω—ã–º –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã?',
  '–í—ã –æ–±—ã—á–Ω–æ —Ç–∏—Ö–æ —Å–∏–¥–∏—Ç–µ –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫–∞—Ö –∏–ª–∏ –≤ –∫–æ–º–ø–∞–Ω–∏–∏?',
  '–í –¥–µ—Ç—Å—Ç–≤–µ –≤—ã –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–ª–∏ —Ç–æ, —á—Ç–æ –≤–∞–º –≥–æ–≤–æ—Ä–∏–ª–∏, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤?',
  '–ò–Ω–æ–≥–¥–∞ —É –≤–∞—Å –±—ã–≤–∞–µ—Ç –ø–ª–æ—Ö–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?',
  '–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ —Å—Å–æ—Ä–∏—Ç—Å—è, –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –º–æ–ª—á–∞—Ç—å –∏ –Ω–∞–¥–µ—è—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —É–ª–∞–¥–∏—Ç—Å—è?',
  '–£ –≤–∞—Å –ª–µ–≥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?',
  '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è –±—ã—Ç—å —Å—Ä–µ–¥–∏ –ª—é–¥–µ–π?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ —É—Å–Ω—É—Ç—å –∏–∑-–∑–∞ —Å–≤–æ–∏—Ö –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏–π?',
  '–ë—ã–≤–∞–µ—Ç, —á—Ç–æ –≤—ã —É–ø—Ä—è–º–∏—Ç–µ—Å—å?',
  '–í—ã —Å—á–∏—Ç–∞–µ—Ç–µ —Å–µ–±—è —á–µ—Å—Ç–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤–∞–º –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç–ª–∏—á–Ω—ã–µ –∏–¥–µ–∏ —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ?',
  '–í–∞–º –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–º—É?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏, —á—Ç–æ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —É—Å—Ç–∞–≤—à–∏–º –∏ –±–µ–∑ —Å–∏–ª –±–µ–∑ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏—á–∏–Ω—ã?',
  '–í—ã –ø–æ –Ω–∞—Ç—É—Ä–µ —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π —á–µ–ª–æ–≤–µ–∫?',
  '–í–∞–º —Å–º–µ—à–Ω–æ, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ —à—É—Ç–∏—Ç –Ω–µ–ø—Ä–∏–ª–∏—á–Ω–æ?',
  '–ß–∞—Å—Ç–æ –ª–∏ —á—Ç–æ-—Ç–æ –≤–∞—Å —Ç–∞–∫ —É—Ç–æ–º–ª—è–µ—Ç, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å?',
  '–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –Ω–µ–∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–¥–µ–∂–¥–µ?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤–∞—à–∏ –º—ã—Å–ª–∏ –±–ª—É–∂–¥–∞—é—Ç, –∫–æ–≥–¥–∞ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è?',
  '–í—ã –º–æ–∂–µ—Ç–µ –±—ã—Å—Ç—Ä–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥—É–º–∞–µ—Ç–µ?',
  '–ë—ã–≤–∞–µ—Ç, —á—Ç–æ –≤—ã –∑–∞–¥—É–º–∞–µ—Ç–µ—Å—å –∏ –Ω–µ —Å–ª—ã—à–∏—Ç–µ, —á—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –≤–æ–∫—Ä—É–≥?',
  '–í—ã —Å–≤–æ–±–æ–¥–Ω—ã –æ—Ç –ø—Ä–µ–¥–≤–∑—è—Ç—ã—Ö –º–Ω–µ–Ω–∏–π?',
  '–í–∞–º –Ω—Ä–∞–≤—è—Ç—Å—è —à—É—Ç–∫–∏ –Ω–∞ 1 –∞–ø—Ä–µ–ª—è?',
  '–ß–∞—Å—Ç–æ –ª–∏ –≤—ã –¥—É–º–∞–µ—Ç–µ –æ —Ç–æ–º, —á—Ç–æ –¥–µ–ª–∞–µ—Ç–µ –Ω–∞ —Ä–∞–±–æ—Ç–µ?',
  '–í—ã –æ—á–µ–Ω—å –ª—é–±–∏—Ç–µ –ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–∫—É—Å–Ω—É—é –µ–¥—É?',
  '–í–∞–º –Ω—É–∂–µ–Ω –¥—Ä—É–≥, —Å –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å, –∫–æ–≥–¥–∞ –≤—ã –∑–ª—ã?',
  '–í–∞–º –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ –∑–∞–Ω–∏–º–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∏–ª–∏ —á—Ç–æ-—Ç–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –≤–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ?',
  '–í—ã –∏–Ω–æ–≥–¥–∞ —Ö–≤–∞—Å—Ç–∞–µ—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ —É—Å–ø–µ—Ö–∞–º–∏?',
  '–í—ã –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –≤–µ—â–∞–º?',
  '–í–∞–º –±—ã —Ö–æ—Ç–µ–ª–æ—Å—å –æ—Å—Ç–∞—Ç—å—Å—è –¥–æ–º–∞, —á–µ–º –∏–¥—Ç–∏ –Ω–∞ —Å–∫—É—á–Ω—É—é –≤–µ—á–µ—Ä–∏–Ω–∫—É?',
  '–ë—ã–≤–∞–µ—Ç, —á—Ç–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ —É—Å–∏–¥–µ—Ç—å –Ω–∞ –º–µ—Å—Ç–µ –æ—Ç –≤–æ–ª–Ω–µ–Ω–∏—è?',
  '–í—ã –ª—é–±–∏—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –¥–µ–ª–∞?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å –≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏—è?',
  '–í—ã –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–∑—É –æ—Ç–≤–µ—á–∞–µ—Ç–µ –Ω–∞ –ø–∏—Å—å–º–∞ –ø–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è?',
  '–í–∞–º –ª–µ–≥—á–µ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É, –µ—Å–ª–∏ –≤—ã —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥—É–º–∞–µ—Ç–µ –æ–± —ç—Ç–æ–º —Å–∞–º–∏?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —É –≤–∞—Å –æ–¥—ã—à–∫–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã –Ω–µ –¥–µ–ª–∞–ª–∏ –Ω–∏—á–µ–≥–æ —Ç—è–∂–µ–ª–æ–≥–æ?',
  '–í—ã –Ω–µ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç–µ, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫?',
  '–í–∞—Å –±–µ—Å–ø–æ–∫–æ—è—Ç –≤–∞—à–∏ –Ω–µ—Ä–≤—ã?',
  '–í–∞–º –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ?',
  '–í—ã –∏–Ω–æ–≥–¥–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç–µ –¥–µ–ª–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞?',
  '–í–∞–º —Å—Ç—Ä–∞—à–Ω–æ –≤ –ª–∏—Ñ—Ç–∞—Ö –∏–ª–∏ –º–µ—Ç—Ä–æ?',
  '–í—ã —á–∞—Å—Ç–æ –ø–µ—Ä–≤—ã–º –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –∫ –Ω–æ–≤—ã–º –ª—é–¥—è–º?',
  '–ë—ã–≤–∞—é—Ç –ª–∏ —É –≤–∞—Å —Å–∏–ª—å–Ω—ã–µ –≥–æ–ª–æ–≤–Ω—ã–µ –±–æ–ª–∏?',
  '–í—ã –æ–±—ã—á–Ω–æ –≤–µ—Ä–∏—Ç–µ, —á—Ç–æ –≤—Å—ë —Å–∞–º–æ —Å–æ–±–æ–π —Ä–µ—à–∏—Ç—Å—è?',
  '–í–∞–º —Ç—Ä—É–¥–Ω–æ –∑–∞—Å–Ω—É—Ç—å –Ω–æ—á—å—é?',
  '–í—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –æ–±–º–∞–Ω—ã–≤–∞–ª–∏ –¥—Ä—É–≥–∏—Ö?',
  '–í—ã –∏–Ω–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç–µ –ø–µ—Ä–≤–æ–µ, —á—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ –≥–æ–ª–æ–≤—É?',
  '–î–æ–ª–≥–æ –ª–∏ –≤—ã –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç–µ –ø–æ—Å–ª–µ –Ω–µ–ª–æ–≤–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏?',
  '–í—ã –æ–±—ã—á–Ω–æ –∑–∞–∫—Ä—ã—Ç—ã —Å –ª—é–¥—å–º–∏, –∫—Ä–æ–º–µ —Å–≤–æ–∏—Ö –±–ª–∏–∑–∫–∏—Ö –¥—Ä—É–∑–µ–π?',
  '–ß–∞—Å—Ç–æ –ª–∏ —É –≤–∞—Å –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ—Å—Ç–∏?',
  '–í–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ —Å–≤–æ–∏–º –¥—Ä—É–∑—å—è–º?',
  '–í–∞–º –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤—ã–∏–≥—Ä—ã–≤–∞—Ç—å, —á–µ–º –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç—å?',
  '–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –Ω–µ–ª–æ–≤–∫–æ —Ä—è–¥–æ–º —Å –ª—é–¥—å–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—à–µ –≤–∞—Å –ø–æ —Å—Ç–∞—Ç—É—Å—É?',
  '–ö–æ–≥–¥–∞ –≤—Å–µ –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫, –≤—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –¥—É–º–∞–µ—Ç–µ, —á—Ç–æ —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞—Ç—å?',
  '–ë—ã–≤–∞–µ—Ç –ª–∏ —É –≤–∞—Å —á—É–≤—Å—Ç–≤–æ –≤–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º?',
];

export function TemperamentTest({ user, onComplete, onBack }: TemperamentTestProps) {
  const [stage, setStage] = useState<'disclaimer' | 'test'>('disclaimer');
  const [variant, setVariant] = useState<'A' | 'B' | null>(null);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [answers, setAnswers] = useState<boolean[]>([]);
  const [time, setTime] = useState(0);
  const [timerRunning, setTimerRunning] = useState(false);

  // –¢–∞–π–º–µ—Ä
  useEffect(() => {
    let interval: NodeJS.Timeout;
    if (timerRunning) {
      interval = setInterval(() => {
        setTime(prev => prev + 1);
      }, 1000);
    }
    return () => clearInterval(interval);
  }, [timerRunning]);

  const questions = variant === 'A' ? questionsA : questionsB;
  const progress = ((currentQuestion + 1) / questions.length) * 100;

  const handleVariantSelect = (selectedVariant: 'A' | 'B') => {
    setVariant(selectedVariant);
    setStage('test');
    setTimerRunning(true);
  };

  const handleAnswer = (answer: boolean) => {
    const newAnswers = [...answers];
    newAnswers[currentQuestion] = answer;
    setAnswers(newAnswers);
  };

  const handleNext = () => {
    if (currentQuestion < questions.length - 1) {
      setCurrentQuestion(currentQuestion + 1);
    }
  };

  const handlePrevious = () => {
    if (currentQuestion > 0) {
      setCurrentQuestion(currentQuestion - 1);
    }
  };

  const handleComplete = () => {
    setTimerRunning(false);

    // –ü–æ–¥—Å—á–µ—Ç –±–∞–ª–ª–æ–≤
    let countExtraIntr = 0;
    let countNeiro = 0;
    let countLie = 0;

    answers.forEach((answer, index) => {
      const questionNumber = index + 1;

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏/–∏–Ω—Ç—Ä–æ–≤–µ—Ä—Å–∏–∏
      if (ExtraIntrMap.hasOwnProperty(questionNumber)) {
        if (ExtraIntrMap[questionNumber] === answer) {
          countExtraIntr++;
        }
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–π—Ä–æ—Ç–∏–∑–º–∞
      if (NeiroMap.hasOwnProperty(questionNumber)) {
        if (NeiroMap[questionNumber] === answer) {
          countNeiro++;
        }
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∫–∞–ª—ã –ª–∂–∏
      if (LieMap.hasOwnProperty(questionNumber)) {
        if (LieMap[questionNumber] === answer) {
          countLie++;
        }
      }
    });

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç–∞
    const results: { [key: string]: number } = {
      extraversion: countExtraIntr,
      neuroticism: countNeiro,
      lie: countLie,
    };

    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    results.time = time;

    const groupResult: Partial<TestResult> = {
      temperament: results,
    };

    onComplete(groupResult);
  };

  const isAnswered = answers[currentQuestion] !== undefined;
  const allAnswered = answers.length === questions.length && answers.every(a => a !== undefined);

  const formatTime = (seconds: number) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  };

  // –î–∏—Å–∫–ª–µ–π–º–µ—Ä
  if (stage === 'disclaimer') {
    return (
      <div className="min-h-screen p-4 py-8">
        <div className="max-w-3xl mx-auto space-y-6">
          <Card>
            <CardHeader>
              <div className="flex items-center gap-3">
                <div className="text-4xl">üé≠</div>
                <div className="flex-1">
                  <CardTitle>–¢–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç</CardTitle>
                  <CardDescription>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç–∞</CardDescription>
                </div>
                <Button variant="outline" onClick={onBack}>
                  <ArrowLeft className="size-4 mr-2" />
                  –ù–∞–∑–∞–¥
                </Button>
              </div>
            </CardHeader>
            <CardContent className="space-y-6">
              <div className="p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-blue-100 rounded-lg mt-0.5">
                    <svg className="size-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                  <div>
                    <p className="text-blue-900 mb-3">
                      –í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∫–∞—Å–∞—é—â–∏–µ—Å—è –≤–∞—à–µ–≥–æ –æ–±—ã—á–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è. 
                      –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ç–∏–ø–∏—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π ¬´–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π¬ª –æ—Ç–≤–µ—Ç, 
                      –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥–µ—Ç –≤–∞–º –≤ –≥–æ–ª–æ–≤—É. –ù–µ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å –ø–æ–¥–æ–ª–≥—É –Ω–∞–¥ –≤–æ–ø—Ä–æ—Å–∞–º–∏, –ø—ã—Ç–∞—è—Å—å 
                      –≤–Ω–∏–∫–Ω—É—Ç—å –≤ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ; –ª—É—á—à–µ –æ—Ç–≤–µ—á–∞—Ç—å —Å—Ä–∞–∑—É, –±—ã—Å—Ç—Ä–æ. –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –Ω–µ—Ç ¬´—Ö–æ—Ä–æ—à–∏—Ö¬ª 
                      –∏–ª–∏ ¬´–ø–ª–æ—Ö–∏—Ö¬ª –æ—Ç–≤–µ—Ç–æ–≤.
                    </p>
                  </div>
                </div>
              </div>

              <div>
                <p className="text-gray-700 mb-4">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç —Ç–µ—Å—Ç–∞:</p>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <Button
                    onClick={() => handleVariantSelect('A')}
                    className="h-auto py-6"
                  >
                    <div className="text-center">
                      <p className="text-xl mb-1">–í–∞—Ä–∏–∞–Ω—Ç –ê</p>
                      <p className="text-sm opacity-90">57 –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                    </div>
                  </Button>
                  <Button
                    onClick={() => handleVariantSelect('B')}
                    className="h-auto py-6"
                  >
                    <div className="text-center">
                      <p className="text-xl mb-1">–í–∞—Ä–∏–∞–Ω—Ç –ë</p>
                      <p className="text-sm opacity-90">57 –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                    </div>
                  </Button>
                </div>
              </div>
            </CardContent>
          </Card>
        </div>
      </div>
    );
  }

  // –¢–µ—Å—Ç
  return (
    <div className="min-h-screen p-4 py-8">
      <div className="max-w-3xl mx-auto space-y-6">
        {/* Header —Å —Ç–∞–π–º–µ—Ä–æ–º */}
        <Card>
          <CardHeader>
            <div className="flex items-center gap-3 mb-4">
              <div className="text-4xl">üé≠</div>
              <div className="flex-1">
                <CardTitle>–¢–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç - –í–∞—Ä–∏–∞–Ω—Ç {variant}</CardTitle>
                <CardDescription>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç–∞</CardDescription>
              </div>
              <div className="flex items-center gap-3">
                <div className="flex items-center gap-2 px-4 py-2 bg-indigo-100 rounded-lg">
                  <Clock className="size-5 text-indigo-600" />
                  <span className="text-indigo-900">{formatTime(time)}</span>
                </div>
                <Button variant="outline" onClick={onBack}>
                  <ArrowLeft className="size-4 mr-2" />
                  –ù–∞–∑–∞–¥
                </Button>
              </div>
            </div>
            <div className="space-y-2">
              <div className="flex items-center justify-between text-sm">
                <span className="text-gray-600">–í–æ–ø—Ä–æ—Å {currentQuestion + 1} –∏–∑ {questions.length}</span>
                <span className="text-indigo-600">{Math.round(progress)}%</span>
              </div>
              <Progress value={progress} />
            </div>
          </CardHeader>
        </Card>

        {/* Question Card */}
        <Card>
          <CardHeader>
            <CardTitle className="text-lg">
              {currentQuestion + 1}. {questions[currentQuestion]}
            </CardTitle>
          </CardHeader>
          <CardContent className="space-y-3">
            <div className="grid grid-cols-2 gap-4">
              <button
                onClick={() => handleAnswer(true)}
                className={`p-6 text-center rounded-xl border-2 transition-all ${
                  answers[currentQuestion] === true
                    ? 'border-green-500 bg-green-50'
                    : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'
                }`}
              >
                <div className="flex flex-col items-center gap-2">
                  <div className={`size-6 rounded-full border-2 flex items-center justify-center ${
                    answers[currentQuestion] === true
                      ? 'border-green-500 bg-green-500'
                      : 'border-gray-300'
                  }`}>
                    {answers[currentQuestion] === true && (
                      <div className="size-3 rounded-full bg-white" />
                    )}
                  </div>
                  <span className={`text-lg ${answers[currentQuestion] === true ? 'text-green-700' : ''}`}>
                    –î–∞
                  </span>
                </div>
              </button>

              <button
                onClick={() => handleAnswer(false)}
                className={`p-6 text-center rounded-xl border-2 transition-all ${
                  answers[currentQuestion] === false
                    ? 'border-red-500 bg-red-50'
                    : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'
                }`}
              >
                <div className="flex flex-col items-center gap-2">
                  <div className={`size-6 rounded-full border-2 flex items-center justify-center ${
                    answers[currentQuestion] === false
                      ? 'border-red-500 bg-red-500'
                      : 'border-gray-300'
                  }`}>
                    {answers[currentQuestion] === false && (
                      <div className="size-3 rounded-full bg-white" />
                    )}
                  </div>
                  <span className={`text-lg ${answers[currentQuestion] === false ? 'text-red-700' : ''}`}>
                    –ù–µ—Ç
                  </span>
                </div>
              </button>
            </div>
          </CardContent>
        </Card>

        {/* Navigation */}
        <Card>
          <CardContent className="pt-6">
            <div className="flex items-center justify-between">
              <Button
                variant="outline"
                onClick={handlePrevious}
                disabled={currentQuestion === 0}
              >
                –ù–∞–∑–∞–¥
              </Button>

              {currentQuestion < questions.length - 1 ? (
                <Button
                  onClick={handleNext}
                  disabled={!isAnswered}
                >
                  –î–∞–ª–µ–µ
                </Button>
              ) : (
                <Button
                  onClick={handleComplete}
                  disabled={!allAnswered}
                  className="bg-green-600 hover:bg-green-700"
                >
                  –ó–∞–≤–µ—Ä—à–∏—Ç—å
                </Button>
              )}
            </div>

            {/* Progress dots */}
            <div className="flex items-center justify-center gap-1 mt-6 flex-wrap">
              {questions.map((_, idx) => (
                <div
                  key={idx}
                  className={`size-2 rounded-full transition-all ${
                    answers[idx] !== undefined
                      ? 'bg-green-500'
                      : idx === currentQuestion
                      ? 'bg-indigo-500 scale-125'
                      : 'bg-gray-300'
                  }`}
                />
              ))}
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
